macOS Management
===============

A collection of little scripts used to do handy things on macOS.

Not everything will be immediately useful to others, but should contain enough to get you set up in your own custom workflow.

-

### ddupd

An uncomplicated dynamic DNS updater. Seriously, ddclient?


### distributemac.sh

A tidying script that does a few Good Things to a system before an image is taken. Basically reminds you to clear the Kerberos KDC files and removes some odds and sods. Could probably do more, too.


### drobologinwait

Holds the login screen while a Drobo, or other storage solution, attaches.


### eraseoldusers.pl

Another tidying script; this one looks through the user directory for any user account data exceeding the 'inactive' threshold. Those accounts that have not been accessed within the timeout period are deleted. The home root, Desktop and Documents folders all need to be sufficiently stale for the deletion to take place. Written in Perl for variety.


### enrolme.sh

Really simple bash script to fetch and install Trust and Enrolment profiles from a server, in the correct order.


### freshadmin.sh

Fetches fresh admin user area from a server and puts it in the right place. Woo.


### powerman.pl

Power management script that ensures our Energy settings are maintained, but also dynamically shuts down systems depending upon how long they've been idle, whether there's still a user that seems to be present, and with variations for different studios.

The fairly insistent resetting of the Energy preferences is mainly a hangover from Mac OS X Tiger, when Energy settings seemed to be altered randomly. However, having this script running occasionally always keeps every system in perfect check, so I'm not changing my game plan.


### replacelibrarywithguest.sh

Replaces the Default User Template Library folder with the one currently in use for the Guest user. Makes tweaking things just that bit quicker and less prone to keyboard slips.


### Resources.app

Very straightforward AppleScript app which checks for the presence of a share, mounts it as Guest if it's missing, then opens a specific directory.


### Store.app

Slightly less straightforward AppleScript app which checks for the presence of a share, attempts to mount it (Finder will prompt for a password unless cached or in the user's Keychain) and then checks for the presence of the user's own storage directory.

If the storage directory is missing, a request is made via HTTP to the server, which will create one from a template with appropriate permissions. This directory is then opened as a new Finder window. If the directory already exists, it's just opened.


### storefor

This Bash script, PHP file and LaunchDaemon .plist make up the 'storefor' generator called by Store.app. The script is called every 10 seconds to check for new Store directory requests, whose need is indicated by a temp file generated by the HTTP call to the PHP file.

To install:

1. The com.studios.storefor.plist goes into /Library/LaunchDaemons - check the permissions are correct, then fire up with launchctl.
2. The storefor.php file goes into a suitable location to be served out by your webserver.
3. The storefor.sh script goes into /usr/local/bin.

Simple, but effective, and probably not massively secure. ;)


### testbroadcast

Just a test broadcast script. Nothing exciting.


### whileout

This little setup runs a process when there is no *console* user logged in. When somebody logs in to the OS X console, the process is killed and script watches for when the user logs out again.

When the system is clear, the process is started again.


### workspacetostore

This quick-and-dirty script looks for a directory in the destination location with the same name as a directory in the source. It then creates a new folder and copies the source to the destination. If it can't find a match, then the failed source is moved out of the way.

